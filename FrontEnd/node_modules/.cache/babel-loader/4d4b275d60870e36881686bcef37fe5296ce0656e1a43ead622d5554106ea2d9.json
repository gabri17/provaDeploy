{"ast":null,"code":"export default {\n  data: () => ({\n    valid: false,\n    dialog: false,\n    username: '',\n    email: '',\n    message: '',\n    mailToSend: ''\n  }),\n  methods: {\n    async ripristinaPassword() {\n      try {\n        fetch(this.$url + \"api/u/getu/\" + this.username, {\n          method: 'GET',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }).then(resp => resp.json()).then(data => {\n          if (data.success !== undefined) {\n            this.$emit('ripristinaPassword', data.message);\n            this.dialog = false;\n            return;\n          }\n          this.email = data.email;\n          this.getNewPass();\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async getNewPass() {\n      try {\n        fetch(this.$url + \"api/l/ripristino\", {\n          method: 'POST',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            username: this.username\n          })\n        }).then(resp => resp.json()).then(data => {\n          this.mailToSend = data.message;\n          this.sendeMail();\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async sendeMail() {\n      try {\n        fetch(this.$url + \"api/m/sendEmail\", {\n          method: 'POST',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            toAddress: this.email,\n            subj: \"Richiesta ripristino password\",\n            message: this.mailToSend\n          })\n        }).then(data => {\n          console.log(data);\n          this.message = \"Controlla la tua casella di posta.\";\n          this.$emit('ripristinaPassword', this.message);\n          this.dialog = false;\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    }\n  }\n};","map":{"version":3,"mappings":"AA+DA;EACAA;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACA;MACA;QACAC;UACAC;UACAC;YAAA;UAAA;QACA,6BACAC;UACA;YACA;YACA;YACA;UACA;UACA;UACA;QACA;MACA;QACAC;MACA;IACA;IACA;MACA;QACAJ;UACAC;UACAC;YAAA;UAAA;UACAG;YACAV;UACA;QACA,6BACAQ;UACA;UACA;QACA;MACA;QACAC;MACA;IACA;IACA;MACA;QACAJ;UACAC;UACAC;YAAA;UAAA;UACAG;YACAC;YACAC;YACAV;UACA;QACA;UACAO;UACA;UACA;UACA;QACA;MACA;QACAA;MACA;IACA;EACA;AACA","names":["data","valid","dialog","username","email","message","mailToSend","methods","fetch","method","headers","then","console","body","toAddress","subj"],"sourceRoot":"src/components","sources":["forgotPassword.vue"],"sourcesContent":["<template>\n    <v-row justify=\"center\">\n      <v-dialog\n        v-model=\"dialog\"\n        persistent\n        max-width=\"360px\"\n      >\n        <template v-slot:activator=\"{ on, attrs }\">\n            <h3\n            class=\"grey--text\"\n            dark\n            v-bind=\"attrs\"\n            v-on=\"on\"\n            >\n            Forgot your password???\n        </h3>\n        </template>\n        <v-card >\n          <v-card-title>\n            <h3 class=\"text-center accent--text\"\n            align=\"center\">Inserisci il tuo username!</h3>\n            <div class=\"font-weight-light \">Ti invieremo al pi√π presto una mail </div>\n            <div class=\"font-weight-light\">con le istruzioni per procedere.\n            </div>\n          </v-card-title>\n          <v-form class=\"submit\" v-model=\"valid\">\n                <v-card-text>\n                    <v-container>\n                        <v-text-field\n                        label=\"username\"\n                        v-model=\"username\"\n                        required\n                        color=\"accent\"\n                        :rules=\"[v=>!!v||'Username necessario!']\"\n                        ></v-text-field>\n                    </v-container>\n                </v-card-text>\n                <v-card-actions>\n                    <v-btn\n                    color=\"red\"\n                    rounded\n                    text\n                    @click=\"dialog = false\"\n                    >\n                    <v-icon>mdi-close</v-icon>\n                </v-btn>\n                <v-spacer></v-spacer>\n                <v-btn\n                color=\"indigo lighten-1\"\n                text\n                :disabled=\"!valid\"\n                @click=\"ripristinaPassword\"\n                > Send me an Email!\n                <v-icon>mdi-email</v-icon>\n                </v-btn>\n                </v-card-actions>\n            </v-form> \n        </v-card>\n      </v-dialog>\n    </v-row>\n  </template>\n\n<script>\nexport default {\n    data: () => ({\n        valid: false,\n        dialog: false,\n        username: '',\n        email: '',\n        message: '',\n        mailToSend: '',\n    }),\n    methods: {\n        async ripristinaPassword() {\n            try {\n                fetch(this.$url + \"api/u/getu/\" + this.username, {\n                    method: 'GET',\n                    headers: { \"Content-Type\": \"application/json\" }\n                }).then((resp) => resp.json())\n                    .then(data => {\n                        if(data.success !== undefined) {\n                             this.$emit('ripristinaPassword', data.message);\n                             this.dialog=false;\n                             return;\n                        }\n                        this.email = data.email;\n                        this.getNewPass();\n                    })\n            } catch (error) {\n                console.error(error);\n            }\n        },\n        async getNewPass() {\n            try {\n                fetch(this.$url + \"api/l/ripristino\", {\n                    method: 'POST',\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({\n                        username: this.username,\n                    })\n                }).then((resp) => resp.json())\n                    .then(data => {\n                        this.mailToSend = data.message\n                        this.sendeMail();\n                    })\n                } catch (error) {\n                    console.error(error);\n                }\n        },\n        async sendeMail() {\n            try {\n                fetch(this.$url + \"api/m/sendEmail\", {\n                    method: 'POST',\n                    headers: { \"Content-Type\": \"application/json\" },\n                    body: JSON.stringify({\n                        toAddress: this.email,\n                        subj: \"Richiesta ripristino password\",\n                        message: this.mailToSend\n                    })\n                }).then(data => {\n                        console.log(data);\n                        this.message = \"Controlla la tua casella di posta.\";\n                        this.$emit('ripristinaPassword', this.message)\n                        this.dialog=false;\n                    })\n            } catch (error) {\n                console.error(error);\n            }\n        }\n    }\n}\n</script>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}
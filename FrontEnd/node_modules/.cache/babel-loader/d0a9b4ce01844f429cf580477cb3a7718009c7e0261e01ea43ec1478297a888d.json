{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport router from '@/router';\nimport logoLinkHome from '@/components/logoLinkHome';\nimport forgotPassword from '@/components/forgotPassword';\nexport default {\n  components: {\n    logoLinkHome,\n    forgotPassword\n  },\n  data: () => ({\n    step: 1,\n    metodiPagamento: false,\n    valid: false,\n    erroreRegistrazione: false,\n    accountCreato: false,\n    datiAuth: {},\n    erroreLogin: false,\n    username: '',\n    password: '',\n    password1: '',\n    email: '',\n    nome: '',\n    cognome: '',\n    dob: '',\n    indirizzo: '',\n    mailPayPal: '',\n    messaggioErroreRegistrazione: '',\n    messageErroreLogin: '',\n    messaggioRipristino: '',\n    required: [v => !!v || 'Campo obbligatorio'],\n    emailRules: [v => /^(([^<>()[\\]\\\\.,;:\\s@']+(\\.[^<>()\\\\[\\]\\\\.,;:\\s@']+)*)|('.+'))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(v) || 'E-mail non valida.'],\n    metodiPagRules: [v => !v || /^(([^<>()[\\]\\\\.,;:\\s@']+(\\.[^<>()\\\\[\\]\\\\.,;:\\s@']+)*)|('.+'))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(v) || 'E-mail non valida.'],\n    passwordCrit: [v => v.match(/^(?=.*[0-9])(?=.*[!£%&?€=^])[a-zA-Z0-9!£%&?€=^*]{8,15}/) !== null || 'Password non valida!']\n  }),\n  props: {\n    source: String\n  },\n  methods: {\n    passwordMatching() {\n      if (this.password === this.password1) {\n        return true;\n      } else {\n        return \"Le password non combaciano!\";\n      }\n    },\n    async handleSubmit() {\n      try {\n        fetch(this.$url + \"api/u/signUp\", {\n          method: 'POST',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            username: this.username,\n            password: this.password,\n            nome: this.nome,\n            cognome: this.cognome,\n            datadinascita: this.dob,\n            indirizzo: this.indirizzo,\n            email: this.email,\n            metodiPagamento: this.mailPayPal\n          })\n        }).then(resp => resp.json()).then(data => {\n          console.log(data);\n          if (data.success === false) {\n            console.log(\"erroreeeee\");\n            this.messaggioErroreRegistrazione = data.message;\n            console.log(data.message, \" === \", this.messaggioErroreRegistrazione);\n            this.erroreRegistrazione = true;\n            return;\n          }\n          this.salvaProfilo();\n          this.accountCreato = true;\n          this.step = 1;\n          this.$refs.form.reset();\n          this.erroreRegistrazione = false;\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async salvaProfilo() {\n      try {\n        fetch(this.$url + \"api/p/savep\", {\n          method: 'POST',\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"x-token-access\": this.$store.getters.token\n          },\n          body: JSON.stringify({\n            \"descrizioneProfilo\": \"Benvenuti sul mio profilo!\",\n            \"idUtente\": this.username\n          })\n        }).then(resp => resp.json()).then(data => {\n          console.log(data);\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async login() {\n      //console.log(this.username, \" \", this.password)\n      try {\n        fetch(this.$url + \"api/l/signIn\", {\n          method: 'POST',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          },\n          body: JSON.stringify({\n            username: this.username,\n            password: this.password\n          })\n        }).then(resp => resp.json()).then(data => {\n          // Here you get the data to modify as you please\n          this.$store.commit('autenticazione', data /*{ dataAuth: data, username: this.username }*/);\n          if (data.success) {\n            console.log(data);\n            if (this.acquistoUtenteNonAutenticato) {\n              router.push(\"/productspecs\");\n            } else {\n              router.push(\"/\");\n            }\n            this.$store.state.noNavBar = false;\n            this.getUser();\n            this.getProfile();\n          } else {\n            this.erroreLogin = true;\n          }\n          this.messageErroreLogin = data.message;\n          console.log(data.messamessageErroreLoginge);\n        });\n      } catch (error) {\n        console.error(error); // If there is any error you will catch them here\n      }\n    },\n\n    async getProfile() {\n      console.log(\"dentro get profile\");\n      try {\n        fetch(this.$url + \"api/p/getp/\" + this.username, {\n          method: 'GET',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }).then(resp => resp.json()).then(data => {\n          this.$store.commit('prendiProfiloUtente', data);\n          console.log(data);\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async getUser() {\n      try {\n        fetch(this.$url + \"api/u/getu/\" + this.username, {\n          method: 'GET',\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }).then(resp => resp.json()).then(data => {\n          this.$store.commit('prendiDatiUtente', data);\n          console.log(data);\n        });\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    esitoRipristino(esito) {\n      this.messaggioRipristino = esito;\n    }\n  },\n  watch: {\n    erroreRegistrazione() {\n      setTimeout(() => {\n        this.erroreRegistrazione = false;\n      }, 3000);\n    },\n    erroreLogin() {\n      setTimeout(() => {\n        this.erroreLogin = false;\n      }, 3000);\n    }\n  },\n  computed: {\n    acquistoUtenteNonAutenticato() {\n      return this.$store.state.prodottoInBallo;\n    },\n    messaggioErrore() {\n      return this.messageErroreRegistrazione;\n    }\n  },\n  mounted() {\n    this.$store.state.noNavBar = true;\n    this.$store.state.search = false;\n  }\n};","map":{"version":3,"mappings":";AA6IA;AACA;AACA;AAEA;EACAA;IAAAC;IAAAC;EAAA;EACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC;IACAC,WACAC,iCACA;IACAC,aACAD,+LACA;IACAE,iBACAF,qMACA;IACAG,eACAH;EAEA;EACAI;IACAC;EACA;EACAC;IACAC;MACA;QACA;MACA;QACA;MACA;IACA;IACA;MACA;QACAC;UACAC;UACAC;YAAA;UAAA;UACAC;YACAxB;YACAC;YACAG;YACAC;YACAoB;YACAlB;YACAJ;YACAT;UACA;QACA,6BACAgC;UACAC;UACA;YACAA;YACA;YACAA;YACA;YACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA;MACA;QACAA;MACA;IACA;IACA;MACA;QACAN;UACAC;UACAC;YACA;YACA;UACA;UACAC;YACA;YACA;UACA;QACA,6BACAE;UACAC;QACA;MACA;QACAA;MACA;IACA;IACA;MACA;MACA;QACAN;UACAC;UACAC;YAAA;UAAA;UACAC;YAAAxB;YAAAC;UAAA;QACA,6BACAyB;UACA;UACA;UACA;YACAC;YACA;cACAC;YACA;cACAA;YACA;YACA;YACA;YACA;UACA;YACA;UACA;UACA;UACAD;QACA;MACA;QACAA;MACA;IACA;;IACA;MACAA;MACA;QACAN;UACAC;UACAC;YAAA;UAAA;QACA,6BACAG;UACA;UACAC;QACA;MACA;QACAA;MACA;IACA;IACA;MACA;QACAN;UACAC;UACAC;YAAA;UAAA;QACA,6BACAG;UACA;UACAC;QACA;MACA;QACAA;MACA;IACA;IACAE;MACA;IACA;EAEA;EACAC;IACAlC;MACAmC;QAAA;MAAA;IACA;IACAhC;MACAgC;QAAA;MAAA;IACA;EACA;EACAC;IACAC;MACA;IACA;IACAC;MACA;IACA;EAEA;EACAC;IACA;IACA;EACA;AACA","names":["components","logoLinkHome","forgotPassword","data","step","metodiPagamento","valid","erroreRegistrazione","accountCreato","datiAuth","erroreLogin","username","password","password1","email","nome","cognome","dob","indirizzo","mailPayPal","messaggioErroreRegistrazione","messageErroreLogin","messaggioRipristino","required","v","emailRules","metodiPagRules","passwordCrit","props","source","methods","passwordMatching","fetch","method","headers","body","datadinascita","then","console","router","esitoRipristino","watch","setTimeout","computed","acquistoUtenteNonAutenticato","messaggioErrore","mounted"],"sourceRoot":"src/views","sources":["UserLoginSignUp.vue"],"sourcesContent":["<template>\n  <v-main id=\"inspire\">\n\n\n      <v-container class=\"fill-height\" fluid>\n        <v-row align=\"center\" justify=\"center\">\n          <v-col cols=\"12\" sm=\"8\" md=\"8\">\n            <v-row>\n              <div class=\"mx-auto pa-10\">\n                <logoLinkHome />\n              </div>\n            </v-row>\n            <v-card class=\"elevation-12\">\n              <v-window v-model=\"step\" class=\"spacing-playground pa-6\">\n                <v-window-item :value=\"1\">\n                  <v-row>\n                    <v-col cols=\"12\" md=\"8\">\n                      <v-card-text class=\"mt-12\">\n                        <h1 class=\"text-center display-2 accent--text\">Accedi a Spottythings</h1>\n                        <v-form ref=\"form\" class =\"submit\" v-model=\"valid\">\n                          <v-text-field label=\"Username\" name=\"username\" prepend-icon=\"person\" type=\"username\"\n                            color=\"accent\" v-model=\"username\" :rules=\"required\"/>\n\n                          <v-text-field id=\"password\" label=\"Password\" name=\"password\" prepend-icon=\"lock\"\n                            type=\"password\" color=\"accent\" v-model=\"password\" :rules=\"required\"/>\n                            <!-- FORGOT PASSWORD -->\n                            <forgotPassword @ripristinaPassword=\"esitoRipristino\"/>\n                            <div class=\"text-center mt-3\">\n                              <v-btn class=\"submit\" rounded color=\"accent accent-3\"  :disabled=!valid @click=\"login\" >SIGN IN</v-btn>\n                            </div>\n                          </v-form>\n                        </v-card-text>\n\n                      <v-container>\n                        <v-alert v-if=\"accountCreato\" type=\"success\" justify=\"center\" dismissible>\n                          Registrazione avvenuta con successo!\n                        </v-alert>\n                        <v-alert v-if=\"acquistoUtenteNonAutenticato\" type=\"error\" justify=\"center\" dismissible>\n                          Effettuare il login prima di poter procedere alla transazione!\n                        </v-alert>\n                        <v-alert v-if=\"erroreLogin\" type=\"error\" justify=\"center\" dismissible>\n                          {{ messageErroreLogin }}\n                        </v-alert>\n                        <v-alert> {{ messaggioRipristino }} </v-alert>\n                      </v-container>\n                    </v-col>\n                    <v-col cols=\"12\" md=\"4\" class=\"accent accent-3\">\n                      <v-card-text class=\"black--text mt-12\">\n                        <h3 class=\"text-center\">Non hai ancora un profilo?</h3>\n                      </v-card-text>\n                      <div class=\"text-center\">\n                        <v-btn rounded dark @click=\"step++\">SIGN UP</v-btn>\n                      </div>\n                    </v-col>\n                  </v-row>\n\n                </v-window-item>\n                <v-window-item :value=\"2\">\n                  <v-row class=\"fill-height\">\n                    <v-col cols=\"12\" md=\"4\" class=\"accent accent-3\">\n                      <v-card-text class=\"black--text mt-12\">\n\n                        <h3 class=\"text-center\">Hai già un profilo?</h3>\n                      </v-card-text>\n                      <div class=\"text-center\">\n                        <v-btn rounded dark @click=\"step--\">Sign in</v-btn>\n                      </div>\n                    </v-col>\n\n                    <v-col cols=\"12\" md=\"8\">\n                      <v-card-text class=\"mt-12 mb-0\">\n                        <h1 class=\"text-center display-2 accent--text text--accent-3\">Crea un Account</h1>\n\n\n                        <v-form v-model=\"valid\" class=\"submit\">\n                          <v-text-field v-model=\"username\" id=\"username\" label=\"Nome utente\" name=\"Username\"\n                            prepend-icon=\"person\" type=\"text\" required color=\"accent accent-3\" :rules=\"required\" />\n                          <v-text-field v-model=\"nome\" id=\"nome\" label=\"Nome\" name=\"Nome\" prepend-icon=\"person\" required\n                            type=\"text\" color=\"accent accent-3\" :rules=\"required\" />\n                          <v-text-field v-model=\"cognome\" id=\"cognome\" label=\"Cognome\" name=\"Cognome\" required\n                            prepend-icon=\"person\" type=\"text\" color=\"accent accent-3\" :rules=\"required\" />\n                          <v-text-field v-model=\"dob\" id=\"dob\" label=\"Data di nascita\" name=\"DOB\" required\n                            prepend-icon=\"mdi-calendar-blank\" type=\"date\" color=\"accent accent-3\" :rules=\"required\" />\n                          <v-text-field v-model=\"indirizzo\" id=\"indirizzo\" label=\"Indirizzo\" placeholder=\"via Sommarive 9, Povo, Trento\" name=\"Indirizzo\" required\n                            prepend-icon=\"map\" type=\"text\" color=\"accent accent-3\" :rules=\"required\" />\n                          <v-text-field v-model=\"email\" id=\"email\" label=\"Email\" name=\"Email\" prepend-icon=\"email\"\n                            type=\"email\" color=\"accent accent-3\" required :rules=\"emailRules\" />\n                          <v-text-field v-model=\"password\" id=\"password\"\n                            label=\"Password (Almeno 8 caratteri, un numero ed un carattere speciale ! £ % ? € = ^ \"\n                            name=\"Password\"\n                            required\n                            prepend-icon=\"lock\" type=\"password\" color=\"accent accent-3\"\n                            :rules=\"required.concat(passwordCrit)\" />\n                          <v-text-field v-model=\"password1\" id=\"confirmPassword\" label=\"Confirm Password\"\n                            name=\"cPassword\" prepend-icon=\"lock\" type=\"password\" color=\"accent accent-3\"\n                            :rules=\"required.concat(passwordMatching)\" \n                            required/>\n                          <v-checkbox\n                            color=\"indigo\"\n                            label=\"Aggiungi Metodo di Pagamento?\"\n                            v-model=\"metodiPagamento\"\n                            hide-details\n                            class=\"shrink mr-2 mt-0\"\n                          ></v-checkbox>\n                          <v-text-field\n                            v-if=\"metodiPagamento\"\n                            v-model=\"mailPayPal\"\n                            id=\"paypal\"\n                            name=\"paypal\"\n                            prepend-icon=\"mdi-account-credit-card\"\n                            label=\"Metodo di Pagamento\"\n                            placeholder=\"PayPal\"\n                            color=\"accent accent-3\"\n                            :rules=\"metodiPagRules\"\n                          ></v-text-field>\n                          <v-spacer></v-spacer>\n                          <v-btn class=\"submit\" rounded color=\"accent accent-3\"  :disabled=!valid\n                            @click=\"handleSubmit\">Crea un Account</v-btn>\n                          <div class=\"text-center mt-n5\">\n                          </div>\n                        </v-form>\n                      </v-card-text>\n                      <v-spacer></v-spacer>\n                      <v-container>\n                        <v-alert v-if=\"erroreRegistrazione\" type=\"error\" justify=\"center\" dismissible>\n                          {{ messaggioErrore }}\n                        </v-alert>\n                      </v-container>\n                    </v-col>\n                  </v-row>\n                </v-window-item>\n              </v-window>\n            </v-card>\n          </v-col>\n        </v-row>\n      </v-container>\n\n  </v-main>\n</template>\n\n<script>\nimport router from '@/router';\nimport logoLinkHome from '@/components/logoLinkHome';\nimport forgotPassword from '@/components/forgotPassword';\n\nexport default {\n  components: { logoLinkHome, forgotPassword },\n  data: () => ({\n    step: 1,\n    metodiPagamento: false,\n    valid: false,\n    erroreRegistrazione: false,\n    accountCreato: false,\n    datiAuth: {},\n    erroreLogin: false,\n    username: '',\n    password: '',\n    password1: '',\n    email: '',\n    nome: '',\n    cognome: '',\n    dob: '',\n    indirizzo: '',\n    mailPayPal:'',\n    messaggioErroreRegistrazione: '',\n    messageErroreLogin:'',\n    messaggioRipristino: '',\n    required: [\n      v => !!v || 'Campo obbligatorio'\n    ],\n    emailRules: [\n      v => /^(([^<>()[\\]\\\\.,;:\\s@']+(\\.[^<>()\\\\[\\]\\\\.,;:\\s@']+)*)|('.+'))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(v) || 'E-mail non valida.',\n    ],\n    metodiPagRules: [\n      v => !v || /^(([^<>()[\\]\\\\.,;:\\s@']+(\\.[^<>()\\\\[\\]\\\\.,;:\\s@']+)*)|('.+'))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(v) || 'E-mail non valida.',\n    ],\n    passwordCrit: [\n      v => (v.match(/^(?=.*[0-9])(?=.*[!£%&?€=^])[a-zA-Z0-9!£%&?€=^*]{8,15}/))!== null || 'Password non valida!'\n    ] \n  }),\n  props: {\n    source: String\n  },\n  methods: {\n    passwordMatching() {\n      if (this.password === this.password1) {\n        return true;\n      } else {\n        return \"Le password non combaciano!\"\n      }\n    },\n    async handleSubmit() {\n      try {\n        fetch(this.$url + \"api/u/signUp\", {\n          method: 'POST',\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ \n            username: this.username, \n            password: this.password, \n            nome: this.nome, \n            cognome: this.cognome, \n            datadinascita: this.dob, \n            indirizzo: this.indirizzo, \n            email: this.email,\n            metodiPagamento: this.mailPayPal\n          })\n        }).then((resp) => resp.json())\n          .then(data => {\n            console.log(data);\n            if (data.success === false) {\n              console.log(\"erroreeeee\")\n              this.messaggioErroreRegistrazione = data.message;\n              console.log(data.message, \" === \", this.messaggioErroreRegistrazione )\n              this.erroreRegistrazione = true;\n              return;\n            }\n            this.salvaProfilo();\n            this.accountCreato = true;\n            this.step = 1;\n            this.$refs.form.reset();\n            this.erroreRegistrazione = false;\n          })\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async salvaProfilo() {\n      try {\n        fetch (this.$url + \"api/p/savep\", {\n          method: 'POST',\n          headers: {\n            \"Content-Type\": \"application/json\",\n            \"x-token-access\": this.$store.getters.token,\n          },\n          body: JSON.stringify({\n            \"descrizioneProfilo\" : \"Benvenuti sul mio profilo!\",\n            \"idUtente\" : this.username,\n          })\n        }).then((resp) => resp.json())\n        .then(data => {\n          console.log(data);\n        })\n      } catch (error) {\n        console.error(error);\n      }\n    },\n    async login() {\n      //console.log(this.username, \" \", this.password)\n      try {\n        fetch(this.$url + \"api/l/signIn\", {\n          method: 'POST',\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify({ username: this.username, password: this.password }),\n        }).then((resp) => resp.json())\n          .then(data => {\n            // Here you get the data to modify as you please\n          this.$store.commit('autenticazione', data/*{ dataAuth: data, username: this.username }*/);\n            if (data.success) {\n              console.log(data);\n              if (this.acquistoUtenteNonAutenticato) {\n                router.push(\"/productspecs\")\n              } else {\n                router.push(\"/\");\n              }\n              this.$store.state.noNavBar = false;\n              this.getUser();\n              this.getProfile();\n            } else {\n              this.erroreLogin = true\n            }\n            this.messageErroreLogin = data.message;\n            console.log(data.messamessageErroreLoginge);\n          })\n      } catch (error) {\n        console.error(error); // If there is any error you will catch them here\n      }\n    },\n    async getProfile() {\n      console.log(\"dentro get profile\")\n      try {\n        fetch(this.$url + \"api/p/getp/\" + this.username, {\n          method: 'GET',\n          headers: { \"Content-Type\": \"application/json\" }\n        }).then((resp) => resp.json())\n        .then(data => {\n          this.$store.commit('prendiProfiloUtente', data);\n          console.log(data);\n        })\n      } catch(error) {\n        console.error(error); \n      }\n    }, \n    async getUser() {\n      try {\n        fetch(this.$url + \"api/u/getu/\" + this.username, {\n          method: 'GET',\n          headers: { \"Content-Type\": \"application/json\" }\n        }).then((resp) => resp.json())\n        .then(data => {\n          this.$store.commit('prendiDatiUtente', data);\n          console.log(data);\n        })\n      } catch(error) {\n        console.error(error); \n      }\n    },\n    esitoRipristino(esito) {\n      this.messaggioRipristino = esito;\n    },\n\n  },\n  watch: {\n    erroreRegistrazione() {\n      setTimeout(() => {this.erroreRegistrazione = false}, 3000);\n    },\n    erroreLogin() {\n      setTimeout(() => {this.erroreLogin = false}, 3000);\n    }\n  },\n  computed: {\n    acquistoUtenteNonAutenticato() {\n      return this.$store.state.prodottoInBallo;\n    },\n    messaggioErrore() {\n      return this.messageErroreRegistrazione;\n    },\n\n  },\n  mounted() {\n    this.$store.state.noNavBar = true;\n    this.$store.state.search = false; \n  }\n};\n</script>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}